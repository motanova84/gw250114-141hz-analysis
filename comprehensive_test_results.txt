/home/runner/work/gw250114-141hz-analysis/gw250114-141hz-analysis/scripts/analizar_gw250114.py:84: RuntimeWarning: divide by zero encountered in divide
  psd_model[low_f_mask] = 1e-46 * (50/freqs[low_f_mask])**4
âš ï¸  Importando funciones desde validar_gw150914.py
ğŸ”§ TESTS OFFLINE DEL FRAMEWORK MEJORADO
============================================================
Verificando que las mejoras implementadas funcionan correctamente
============================================================

==================================================
ğŸ§ª TEST: GeneraciÃ³n de datos sintÃ©ticos
==================================================
ğŸ§ª Probando generaciÃ³n de datos sintÃ©ticos...
ğŸ§ª Generando datos sintÃ©ticos de GW250114 para testing...
   âœ… Datos sintÃ©ticos generados: 32s a 4096 Hz
   âœ… Ruido coloreado realista generado
   âœ… SeÃ±al insertada: Dominante 250.0 Hz (A=1.0e-21) + Objetivo 141.7 Hz (A=3.0e-22)
   âœ… Ringdown: 49.8ms post-merger
   âœ… Datos generados correctamente
   âœ… H1: 131072 muestras, std=1.36e-23
   âœ… L1: 131072 muestras, std=1.17e-23

==================================================
ğŸ§ª TEST: CÃ¡lculo de Bayes Factor
==================================================

ğŸ§® Probando cÃ¡lculo de Bayes Factor...
ğŸ§® Calculando Bayes Factor para 100.0 Hz...
   ChiÂ² modelo Ãºnico: 1.24e-41
   ChiÂ² modelo doble: 1.22e-41
   Î”Ï‡Â²: 1.79e-43
   Bayes Factor: 0.14
ğŸ§® Calculando Bayes Factor para 200.0 Hz...
   ğŸ’¡ Mejora mÃ­nima detectada (0.39%)
   ChiÂ² modelo Ãºnico: 1.24e-41
   ChiÂ² modelo doble: 1.23e-41
   Î”Ï‡Â²: 4.78e-44
   Bayes Factor: 0.14
   âœ… BF para 100 Hz (seÃ±al presente): 0.14
   âœ… BF para 200 Hz (sin seÃ±al): 0.14
   âœ… CÃ¡lculo de Bayes Factor funcionando

==================================================
ğŸ§ª TEST: EstimaciÃ³n de p-value
==================================================

ğŸ“Š Probando estimaciÃ³n de p-value...
ğŸ“Š Estimando p-value con 100 time-slides...
   Frecuencia objetivo: 150.0 Hz (bin: 140.55 Hz)
   SNR observado: 31010.98
   SNR medio background: 28632.11
   SNR std background: 1727.20
   Slides vÃ¡lidos: 100/100
   p-value estimado: 0.1300
   âœ… p-value estimado: 0.1300
   âœ… SNR observado: 31010.98
   âœ… Background slides: 100
   âœ… EstimaciÃ³n de p-value funcionando

============================================================
ğŸ“ˆ RESUMEN DE TESTS
============================================================
âœ… Ã‰XITO: GeneraciÃ³n de datos sintÃ©ticos
âœ… Ã‰XITO: CÃ¡lculo de Bayes Factor
âœ… Ã‰XITO: EstimaciÃ³n de p-value

Tests pasados: 3/3 (100.0%)

ğŸ‰ Â¡TODOS LOS TESTS OFFLINE EXITOSOS!
âœ… Framework mejorado funcionando correctamente
ğŸš€ Listo para uso en anÃ¡lisis cientÃ­fico
